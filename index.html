
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kim's Family</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Pen+Script&display=swap" rel="stylesheet">
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Kim's Family</h1>
        <nav>
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#lotto">Lotto</a></li>
                <li><a href="#calendar">Calendar</a></li>
                <li><a href="#gallery">Gallery</a></li>
                <li><a href="#info">Info</a></li>
                <li><a href="#recommendation">Recommendation</a></li>
                <li><a href="#game">Game</a></li>
                <li><a href="#comments">Comments</a></li>
            </ul>
        </nav>
        <div class="header-buttons">
            <button id="music-toggle">ðŸŽµ</button>
            <button id="theme-toggle">ðŸŒ™</button>
        </div>
    </header>

    <main>
        <div id="player" style="display: none;"></div>

        <section id="home">
            <div id="home-image-container">
                <img id="home-image" src="https://res.cloudinary.com/dklpq8xg8/image/upload/v1770831201/soyul_zpeges.png" alt="Family Photo">
            </div>
            <div id="home-text-container">
                <h2>Welcome to our Family Hub!</h2>
                <p>A place to share memories, stay connected, and celebrate family.</p>
            </div>
        </section>

        <section id="lotto">
            <h2>Lotto Number Generator</h2>
            <div id="lotto-controls">
                <div class="lotto-group">
                    <h3>ðŸ‡°ðŸ‡· Korea Lotto</h3>
                    <button class="lotto-button" data-lotto-type="korea-645">Lottery 6/45</button>
                    <button class="lotto-button" data-lotto-type="korea-720">Pension Lottery 720+</button>
                </div>
                <div class="lotto-group">
                    <h3>ðŸ‡ºðŸ‡¸ USA Lotto</h3>
                    <button class="lotto-button" data-lotto-type="usa-powerball">Powerball</button>
                    <button class="lotto-button" data-lotto-type="usa-megamillions">Mega Millions</button>
                </div>
                <div class="lotto-group">
                    <h3>ðŸ‡¨ðŸ‡¦ Canada Lotto</h3>
                    <button class="lotto-button" data-lotto-type="canada-649">Lotto 6/49</button>
                    <button class="lotto-button" data-lotto-type="canada-lottomax">Lotto MAX</button>
                </div>
            </div>
            <div id="lotto-display-area">
                <p>Click a lottery button to generate numbers.</p>
            </div>
        </section>

        <section id="calendar">
            <h2>Family Calendar</h2>
            <div id="calendar-container"></div>
        </section>

        <section id="gallery">
            <h2>Photo Gallery</h2>
            <div id="upload-container">
                <input type="file" id="file-input" accept="image/*">
                <button id="upload-button">Upload Photo</button>
                <progress id="upload-progress" value="0" max="100" style="display: none;"></progress>
            </div>
            <div id="gallery-container">
                <!-- Uploaded photos will be displayed here -->
            </div>
        </section>

        <section id="info">
            <h2>Useful Information</h2>
            <div class="info-links">
                <div id="info-news">
                    <h3>News</h3>
                    <ul id="news-links-list"></ul>
                </div>
                <div id="info-government">
                    <h3>Government</h3>
                    <ul id="government-links-list"></ul>
                </div>
                <div id="info-education">
                    <h3>Education</h3>
                    <ul id="education-links-list"></ul>
                </div>
                <div id="info-fun">
                    <h3>Fun</h3>
                    <ul id="fun-links-list"></ul>
                </div>
            </div>
            <div id="add-link-form-container">
                <h3>Add a New Link</h3>
                <form id="add-link-form">
                    <div class="form-group">
                        <label for="link-title">Title:</label>
                        <input type="text" id="link-title" required>
                    </div>
                    <div class="form-group">
                        <label for="link-url">URL:</label>
                        <input type="url" id="link-url" required>
                    </div>
                    <div class="form-group">
                        <label for="link-category">Category:</label>
                        <select id="link-category" required>
                            <option value="News">News</option>
                            <option value="Government">Government</option>
                            <option value="Education">Education</option>
                            <option value="Fun">Fun</option>
                        </select>
                    </div>
                    <button type="submit" id="add-link-button">Add Link</button>
                </form>
            </div>
        </section>
        
        <section id="recommendation">
            <h2>Recommendations</h2>
            <div id="add-recommendation-form-container">
                <h3>Add a New Recommendation</h3>
                <form id="add-recommendation-form">
                    <div class="form-group">
                        <label for="recommendation-category">Category:</label>
                        <select id="recommendation-category" required>
                            <option value="book">Book</option>
                            <option value="music">Music</option>
                            <option value="movie">Movie</option>
                        </select>
                    </div>

                    <!-- Common field for all -->
                    <div class="form-group">
                        <label for="recommendation-title">Title:</label>
                        <input type="text" id="recommendation-title" required>
                    </div>

                    <!-- Movie specific fields -->
                    <div class="form-group movie-field">
                        <label for="recommendation-date">Date:</label>
                        <input type="date" id="recommendation-date">
                    </div>
                    <div class="form-group movie-field">
                        <label for="recommendation-name">Name:</label>
                        <select id="recommendation-name">
                            <option value="Seonyul">Seonyul</option>
                            <option value="Soyul">Soyul</option>
                            <option value="Siyul">Siyul</option>
                        </select>
                    </div>

                    <!-- Book/Music specific fields -->
                    <div class="form-group book-music-field" id="recommendation-field1-group">
                        <label for="recommendation-field1" id="recommendation-field1-label">Author:</label>
                        <input type="text" id="recommendation-field1">
                    </div>
                    <div class="form-group book-music-field" id="recommendation-field2-group">
                        <label for="recommendation-field2">Comment:</label>
                        <textarea id="recommendation-field2" rows="3"></textarea>
                    </div>

                    <button type="submit" id="add-recommendation-button">Add Recommendation</button>
                </form>
            </div>
            <div class="recommendations-container">
                <div class="recommendation-category-container">
                    <h3>Books</h3>
                    <div id="book-list" class="recommendation-list"></div>
                </div>
                <div class="recommendation-category-container">
                    <h3>Music</h3>
                    <div id="music-list" class="recommendation-list"></div>
                </div>
                <div class="recommendation-category-container">
                    <h3>Movies</h3>
                    <div id="movie-list" class="recommendation-list"></div>
                </div>
            </div>
        </section>

        <section id="game">
            <h2>1945 Family Game - Ultimate</h2>
            <div id="ui">
                Name: <input id="playerName" value="Player" style="width:80px"><br>
                Score: <span id="score">0</span> Stage: <span id="stage">1</span>
            </div>
            <div id="leaderboard">
                Top Scores<br>
                <div id="rankList"></div>
            </div>
            <div id="gameover">
                <h1>GAME OVER</h1>
                <button onclick="restart()">Restart</button>
            </div>
            <canvas id="game-canvas" width="400" height="600"></canvas>
        </section>

        <div id="recommendation-modal" class="modal">
            <div class="modal-content">
                <span class="close-button">&times;</span>
                <h3 id="recommendation-modal-title"></h3>
                <div id="recommendation-modal-details"></div>
            </div>
        </div>

        <section id="comments">
            <h2>Comments</h2>
            <div id="disqus_thread"></div>
        </section>
    </main>

    <div id="image-modal" class="modal">
        <span class="close-button">&times;</span>
        <img class="modal-content" id="modal-image">
    </div>

    <footer>
        <section id="contact">
            <h2>Partnership Inquiry</h2>
            <p>If you have any questions, please fill out the form below. Your message will be sent securely via Formspree.</p>
            <form action="https://formspree.io/f/xjgowyzz" method="POST" id="partnership-form">
                <div class="form-group">
                    <label for="name">Name:</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="message">Message:</label>
                    <textarea id="message" name="message" rows="5" required></textarea>
                </div>
                <button type="submit">Submit</button>
            </form>
        </section>
        <p>&copy; 2024 Kim's Family</p>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/@fullcalendar/google-calendar@5.11.3/main.global.min.js'></script>
    <script id="dsq-count-scr" src="//myfamily-3.disqus.com/count.js" async></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="main.js" type="module"></script>
    <script>
    (function() {
        const firebaseConfig = {
            apiKey: "AIzaSyBPTUgBQVsdQ8zsHCmE6CtjcL3LASoweLs",
            authDomain: "my-family-in-canada-8348-d04e1.firebaseapp.com",
            projectId: "my-family-in-canada-8348-d04e1",
            storageBucket: "my-family-in-canada-8348-d04e1.appspot.com",
            messagingSenderId: "1043656805377",
            appId: "1:1043656805377:web:902d6f8dc9dcbb95be4400"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const scoresCol = db.collection('scores');

        const canvas = document.getElementById("game-canvas");
        const ctx = canvas.getContext("2d");

        let keys = {};
        let bullets = [];
        let enemies = [];
        let enemyBullets = [];
        let explosions = [];
        let score = 0;
        let stage = 1;
        let running = true;
        let boss = null;
        let stars=[];

        for(let i=0;i<50;i++){stars.push({x:Math.random()*400,y:Math.random()*600,r:Math.random()*2+1,speed:Math.random()*1+0.5});}

        const shootAudio = new Audio("https://freesound.org/data/previews/341/341695_6242930-lq.mp3");
        const explosionAudio = new Audio("https://freesound.org/data/previews/174/174055_3242494-lq.mp3");
        const bgmAudio = new Audio("https://freesound.org/data/previews/522/522828_10011386-lq.mp3");
        bgmAudio.loop = true;
        bgmAudio.volume = 0.3;
        bgmAudio.play().catch(()=>{}); 

        function updateLeaderboard() {
            scoresCol.orderBy('score','desc').limit(5).get().then(snapshot=>{
                let html="";
                snapshot.forEach((doc,i)=>{
                    const d=doc.data();
                    html+=`${i+1}. ${d.name} ${d.score}<br>`;
                });
                document.getElementById("rankList").innerHTML=html;
            });
        }
        updateLeaderboard();

        const player = {x:180,y:500,w:40,h:40,speed:5};

        document.addEventListener("keydown",e=>keys[e.key]=true);
        document.addEventListener("keyup",e=>keys[e.key]=false);
        canvas.addEventListener("touchmove", e=>{
            let rect = canvas.getBoundingClientRect();
            let touch = e.touches[0];
            player.x = touch.clientX - rect.left - player.w/2;
            player.y = touch.clientY - rect.top - player.h/2;
        });

        setInterval(()=>{if(running){bullets.push({x:player.x+18,y:player.y,w:4,h:10});shootAudio.play();}},250);

        function spawnEnemy(){
            if(!running) return;
            const typeRand=Math.random();
            let type="small";
            if(typeRand<0.6) type="small";
            else if(typeRand<0.9) type="medium";
            else type="large";
            enemies.push({x:Math.random()*(400-40),y:-40,w:type=="small"?30:type=="medium"?50:60,h:type=="small"?30:type=="medium"?50:60,speed:2+Math.random()*stage,type, hp:type=="large"?5:1});
            if(Math.random()<0.05 && !boss) spawnBoss();
            setTimeout(spawnEnemy, 1000- stage*50);
        }
        function spawnBoss(){
            boss = {x:160,y:-100,w:80,h:80,hp:10+stage*5,speed:1,dir:1};
        }
        spawnEnemy();

        setInterval(()=>{
            enemies.forEach(e=>{
                if(Math.random()<0.02){ enemyBullets.push({x:e.x+e.w/2-2,y:e.y+e.h,w:4,h:10,speed:4}); }
            });
            if(boss) enemyBullets.push({x:boss.x+boss.w/2-2,y:boss.y+boss.h,w:6,h:12,speed:5});
        },300);

        function update(){
            if(!running) return;

            if(keys["ArrowLeft"]) player.x-=player.speed;
            if(keys["ArrowRight"]) player.x+=player.speed;
            if(keys["ArrowUp"]) player.y-=player.speed;
            if(keys["ArrowDown"]) player.y+=player.speed;

            bullets.forEach((b,i)=>{b.y-=7;if(b.y<0) bullets.splice(i,1);});

            enemyBullets.forEach((b,i)=>{b.y+=b.speed;if(hit(player,b)) gameOver(); if(b.y>600) enemyBullets.splice(i,1);});

            enemies.forEach((e,i)=>{
                e.y+=e.speed;
                if(hit(player,e)) gameOver();
                if(e.y>600) enemies.splice(i,1);
                bullets.forEach((b,bi)=>{
                    if(hit(b,e)){
                        explosions.push({x:e.x,y:e.y,size:10});bullets.splice(bi,1);
                        e.hp--; if(e.hp<=0){enemies.splice(i,1);score+=e.type=="large"?200:e.type=="medium"?150:100; explosionAudio.play();}
                    }
                });
            });

            if(boss){
                boss.y += boss.speed;
                boss.x += boss.dir*2;
                if(boss.x<0 || boss.x>320) boss.dir*=-1;
                if(hit(player,boss)) gameOver();
                bullets.forEach((b,bi)=>{
                    if(hit(b,boss)){
                        explosions.push({x:boss.x,y:boss.y,size:15}); bullets.splice(bi,1);
                        boss.hp--; score+=50; explosionAudio.play();
                        if(boss.hp<=0){boss=null;stage++;document.getElementById("stage").innerText=stage;} 
                    }
                });
            }

            explosions.forEach((ex,i)=>{ex.size+=2; if(ex.size>30) explosions.splice(i,1);});

            document.getElementById("score").innerText=score;
        }

        function draw(){
            ctx.clearRect(0,0,400,600);
            ctx.fillStyle="white"; stars.forEach(s=>{ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill();s.y+=s.speed;if(s.y>600)s.y=0;s.x=Math.random()*400;});
            ctx.fillStyle="cyan"; ctx.beginPath();
            ctx.moveTo(player.x+20,player.y); ctx.lineTo(player.x,player.y+40); ctx.lineTo(player.x+40,player.y+40); ctx.closePath(); ctx.fill();
            ctx.fillStyle="yellow"; bullets.forEach(b=>ctx.fillRect(b.x,b.y,b.w,b.h));
            ctx.fillStyle="orange"; enemyBullets.forEach(b=>ctx.fillRect(b.x,b.y,b.w,b.h));
            enemies.forEach(e=>{ctx.fillStyle=e.type=="small"?"red":e.type=="medium"?"pink":"purple"; ctx.fillRect(e.x,e.y,e.w,e.h);});
            if(boss){ctx.fillStyle="purple"; ctx.fillRect(boss.x,boss.y,boss.w,boss.h);}
            explosions.forEach(ex=>{ctx.fillStyle=`rgb(${255-ex.size*5},${100},0)`; ctx.beginPath(); ctx.arc(ex.x+20,ex.y+20,ex.size,0,Math.PI*2); ctx.fill();});
        }

        function loop(){update(); draw(); requestAnimationFrame(loop);}
        loop();

        function hit(a,b){return a.x < b.x+b.w && a.x+a.w > b.x && a.y < b.y+b.h && a.y+a.h > b.y;}

        function gameOver(){running=false; saveScore(); document.getElementById("gameover").style.display="block";}
        function saveScore(){
            let name = document.getElementById("playerName").value || "Player";
            scoresCol.add({name,score,stage}).then(updateLeaderboard);
        }

        window.restart = function(){
            score=0; bullets=[]; enemies=[]; enemyBullets=[]; explosions=[]; boss=null; stage=1; running=true; 
            document.getElementById("gameover").style.display="none"; 
            document.getElementById("stage").innerText=1;
        }
    })();

    var disqus_config = function () {
        this.page.url = window.location.href;
        this.page.identifier = "myfamily-3";
    };

    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://myfamily-3.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</body>
</html>
